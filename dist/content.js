(()=>{"use strict";var t=function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function c(t){try{s(o.next(t))}catch(t){r(t)}}function a(t){try{s(o.throw(t))}catch(t){r(t)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,a)}s((o=o.apply(t,n||[])).next())}))};function n(n,e){return t(this,void 0,void 0,(function*(){try{const t=yield fetch(n,Object.assign({headers:{"Content-Type":"application/json",Accept:"application/json"}},e));if(!t.ok)throw new Error(t.statusText);return yield t.json()}catch(t){throw t}}))}function e(t){return+t<10?`0${t}`:`${t}`}function o(t){return[31,28,31,30,31,30,31,31,30,31,30,31][t-1]}function i(t){const n=t.split("/");return{d:+n[0],m:+n[1],y:+n[2]}}function r(t){const{d:n,m:e,y:o}=i(t);return`${e}/${n}/${o}`}var c=function(t,n,e,o){return new(e||(e=Promise))((function(i,r){function c(t){try{s(o.next(t))}catch(t){r(t)}}function a(t){try{s(o.throw(t))}catch(t){r(t)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,a)}s((o=o.apply(t,n||[])).next())}))};function a(t,s=1){return c(this,void 0,void 0,(function*(){let u,l;if(!1===t.default)u=t.first_date,l=t.last_date;else{const t=function(){const{d:t,m:n,y:o}=i(r((new Date).toLocaleDateString())),c=`01/${e(n+3)}/${o}`;return[`${e(t)}/${e(n)}/${o}`,c]}();u=t[0],l=t[1]}try{console.log(`%c [${e(s)}] Script is running on: ${r((new Date).toLocaleString())}`,"font-weight: bold;");const t=function(t,n){const{d:r,m:c,y:a}=i(t),{d:s,m:u}=i(n),l=[],d=[...Array(o(c)-r).keys()].map((t=>`${a}-${e(c)}-${e(t+r+1)}`)),f=c<u?[...Array(s).keys()].map((t=>`${a}-${e(u)}-${e(t+1)}`)):[];for(let t=c+1;t<u;t++)l.push(...[...Array(o(t)).keys()].map((n=>`${a}-${e(t)}-${e(n+1)}`)));return[`${a}-${e(c)}-${e(r)}`,...d,...l,...f]}(u,l),a=(yield function(t,e){return c(this,void 0,void 0,(function*(){const o=`https://eg.almaviva-visa.services/api/sites/disabled-dates/?start=${t}&end=${e}&siteId=22&persons=1&IDtypology=3&IdCategory=1`;return yield n(o,{method:"GET"})}))}(u,l)).map((t=>t.date)),d=t.filter((t=>!a.includes(t)));return console.log("%c Service Available","color: #0f0;font-size: 17px;font-weight: bold;"),void console.table(d)}catch(n){console.log("%c Service Unavailable","color: #f00;font-size: 17px;font-weight: bold;"),yield(3e5,new Promise((t=>setTimeout(t,3e5)))),a(t,s+1)}}))}!function(){c(this,void 0,void 0,(function*(){const{date_range:t}=yield function(){return c(this,void 0,void 0,(function*(){try{const t=chrome.runtime.getURL("input.json");return yield n(t,{method:"GET"})}catch(t){return t}}))}();yield a(t)}))}()})();