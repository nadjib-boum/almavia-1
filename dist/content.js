(()=>{"use strict";const t=new class{async get(t,e){try{const n=await fetch(t);if(!n.ok)throw new Error;let o;return o="text"===e?.format?await n.text():(e?.format,await n.json()),o}catch(t){return Promise.reject(t)}}};function e(){return function(t,e=0){let n,o=[];for(let a=0;a<e;a++)n=new Date(t),n.setDate(n.getDate()+a),o.push(n);return o}(new Date((new Date).setDate(1)),90).map((t=>t.toLocaleDateString("en-GB")))}const n=new class{createElement(t,e,n=document.body,o,a){const r=document.createElement(t);if(n?.appendChild(r),r.textContent=e,o)for(const t in o)r.addEventListener(t,o[t]);if(a)for(const t in a)r.setAttribute(t,a[t].toString());return r}},o=(t,e)=>e.filter((e=>!t.includes(e)));!async function(){const{buttons:a}=await async function(){try{const e=chrome.runtime.getURL("config.json");return await t.get(e)}catch(t){return Promise.reject(t)}}(),r=function(t){const{start:n,end:o}=function(){const t=e();return{start:t[0],end:t[t.length-1]}}();return t.map((t=>({...t,start:n,end:o})))}(a);await async function({apiButtonParams:a}){var r;!function(a,r){const c=[];r.forEach(((r,s)=>{const{label:i}=r;c.push(n.createElement("button",i,a,{click:async()=>{try{const n=(await async function(e){try{const n=function(t){const{start:e,end:n,IDtypology:o,IdCategory:a,siteId:r,persons:c}=t;return`https://eg.almaviva-visa.services/api/sites/disabled-dates/?start=${e}&end=${n}&siteId=${r}&persons=${c}&IDtypology=${o}&IdCategory=${a}`}(e);return await t.get(n)}catch(t){return Promise.reject(t)}}(r)).map((t=>t.date.split("-").reverse().join("/"))),a=e(),c=o(n,a).map((t=>new Date(function(t){const[e,n,o]=t.split("/");return`${n}/${e}/${o}`}(t)))).filter((t=>t>=new Date)).map((t=>t.toLocaleDateString("en-GB")));console.log(`%c ${i}`,"font-size:18px;color: #0f0"),console.table(c)}catch(t){console.log("%c API ERROR","font-size:20px;color: #f00"),console.log(t)}}}))}))}((r=n.createElement("div","",document.body,{},{id:"appContainer"}),n.createElement("div","",r,{},{class:"api-buttons-container"})),a)}({apiButtonParams:r})}()})();